# 卷:将磁盘挂载到容器
## 背景
> POD 内部容器文件系统相互分隔,且绝不持久化,会在POD下一次启动时消失,想要将部分数据持久化需要借用挂载卷的形式，kubernetes 的卷是POD 的一个组成部分,而不是独立的对象,所以他们不能单独直接创建或删除。所有的POD都可以使用卷,卷用于临时或永久保存Pod 运行时产生的数据信息
## 卷的种类
* ***emptyDir***: 存储临时数据的简单空目录，一般用于单POD内多个容器共享 有些容器的文件系统不可写 
* ***gitRepo***: 通过检出git仓库内容来初始化卷,也是一个emptyDir 但有了初始化数据的机，可以和sideCar容器结合获取配置
* ***hostPath***: 将目录从工作节点挂载到 Pod中,一般不允许这样做,某些daemonSet 确实需要读取节点数据，可以采用。真正的第一种持久化类型。
* ***nfs***: 挂载到POD中的NFS 共享卷,新手的方案
* ***gcePersistentDisk***: 谷歌提供的高性能存储磁盘,类似的有 阿里云 腾讯云 亚马逊 微软 土豪的首选方案 
* ***cinder,cepthfs，lscsi，flocker***： 挂载其他类型的网络存储.高性能高可用方案
* ***pvc***：一种使用预制或者动态配置的持久存储类型 通用方案 看具体实现
* ***configMap,downwardAPI,secret***: 将部分kubernetes 自身资源挂载到磁盘的技术 配置文件方案

## 解耦卷的具体实现和使用
>当开发人员需要一定数量的持久化存储来进行应用时,可以向Kubernetes 请求，就想创建Pod 可以请求CPU内存和其他资源一样。在Kubernetes中引入两种资源 PV(持久卷) 和PVC(持久卷声明)研发人员需要使用磁盘保存数据时,向Kubernetes 提供一个持久卷声明清单，描述所需要的最低容量和访问模式。kubernetes 为其匹配对应的具体实现的持久卷,这样研发人员无需关心PV底层的具体实现,解耦了使用和实现方案,持久卷不属于任何命名空间 和节点一样是集群的资源

### 回收持久卷策略
> 通过设置 persistentVolumeReclaimPolicy 
* Retain：手动回收卷
* Recycle: 删除并使其重新可用 会清空数据
* Delete: 删除底层存储 也会从外部基础设施移除所关联的资产

### 动态配置的持久卷
>storageClass 指定当持久卷声明请求指定此StorageClass 时用哪个制备程序来产生持久卷,此时PVC 便可以指定StorageClassName 为对应的storage Class类型
